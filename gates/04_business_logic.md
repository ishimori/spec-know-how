# Gate 4: 業務ロジック

**確認タイミング**: Step 4（業務ロジックを抽出する）完了後

次のステップに進む前に、以下の項目を確認してください。

---

## 抽出の網羅性

- [ ] 主要な業務フロー（Happy Path）を仕様書に記述した
- [ ] 計算ロジック（料金計算・集計処理等）を仕様書に記述した
- [ ] バリデーションルール（入力制約・業務上の制約）を仕様書に記述した
- [ ] 状態遷移（ワークフロー・ステータス管理）を仕様書に記述した
- [ ] 外部システム連携（API 呼び出し・ファイル入出力）を仕様書に記述した

## 信頼度の付与

- [ ] 仕様書の全項目に信頼度（High / Medium / Low / Conflicting）を付与した
- [ ] `Conflicting`（矛盾）の項目がある場合、解消計画を立てた

信頼度の意味:

| 信頼度 | 意味 | 次のアクション |
|--------|------|--------------|
| `High` | コードと照合済み | そのまま使える |
| `Medium` | 一部照合済み | 注意して使う |
| `Low` | 根拠不足・未検証 | 使う前に調査 |
| `Conflicting` | コードと矛盾 | 解消が必要 |

## コードとの突合

- [ ] `High` と記録した項目は、コードの該当箇所を確認済み
- [ ] `Conflicting` の項目が 0 件、または解消計画がある

## 暗黙ルールの確認

- [ ] コードに書かれていない業務運用ルールについてドメインエキスパートに確認した（または確認する計画がある）

> **なぜ重要か**: 仕様書は「コードに書かれたルール」の抽出には優れるが、「運用で暗黙に成立しているルール」はコードから抽出できない。

## DA 批判レビュー（推奨）

- [ ] このステップの成果物に対して DA 批判レビューを実施した（少なくとも1件の問題を発見・対応）

> DA 批判レビューの詳細は [manuals/01_仕様書作成マニュアル.md](../manuals/01_仕様書作成マニュアル.md) を参照。

---

## メモ欄

```
（例）
- 抽出した BR（ビジネスルール）数: 47件
  - High: 23件、Medium: 18件、Low: 4件、Conflicting: 2件
- Conflicting の2件:
  1. BR-012: 残業60時間境界の処理。コードとdocstringで計算方法が異なる
  2. BR-034: 有休付与条件。仕様書（古い）とコードで条件が食い違う
- 暗黙ルール確認中: 白流れの扱い（コードに定義なし、担当者に確認中）
```
