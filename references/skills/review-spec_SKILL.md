---
name: review-spec
description: 実装前チェック検証コマンド
---

# 実装前チェック検証コマンド

新機能の実装前に、仕様確認が正しく行われたかを検証するコマンドです。

## 使い方

```
/review-spec [DD番号]
```

### 例
- `/review-spec DD-005` → DD-005の実装前チェックを検証
- `/review-spec 005` → 同上
- `/review-spec` → 現在作業中のDD（最近更新されたDD）を対象

## 検証内容

### 1. DDに「実装前チェック」セクションが存在するか

以下の形式でチェック結果が記録されているか確認：

```markdown
## 実装前チェック

### チェック実施日: YYYY-MM-DD

#### 1. 仕様書確認
- 参照ファイル: ...
- 確認結果: ...

#### 2. 既存コード確認
- 参照ファイル: ...
- 確認結果: ...

#### 3. 設計書との差分
- 漏れている仕様: ...
- 追加で必要な対応: ...
```

### 2. 必須チェック項目の確認

| No | チェック項目 | 必須 | 確認方法 |
|----|-------------|:---:|---------|
| 1 | 仕様書の確認 | ✓ | `doc/spec/` の参照が記載されているか |
| 2 | 画面仕様の確認 | ✓ | 画面仕様書の参照が記載されているか |
| 3 | テーブル定義の確認 | ✓ | テーブル定義書の参照が記載されているか |
| 4 | 既存コードの確認 | ✓ | 関連する既存コードの参照が記載されているか |
| 5 | 設計書との差分検証 | ✓ | 差分の有無が明記されているか |

### 3. チェック内容の妥当性確認

#### 仕様書確認
- 機能一覧から該当機能を特定できているか
- 画面仕様の要素が漏れなく抽出されているか

#### 既存コード確認
- 対応するコントローラー/サービスが特定されているか
- 主要なメソッドが確認されているか

#### 差分検証
- 仕様書に記載がないがコードに存在する機能はないか
- コードにあるが仕様書に未記載の制約・バリデーションはないか

## 検証手順

### Step 1: DDファイルの読み込み

```bash
# DD番号からファイルを特定（進行中）
doc/DD/DD-{番号}_*.md

# なければアーカイブ済みを探す
doc/archived/DD/DD-{番号}_*.md
```

### Step 2: 「実装前チェック」セクションの確認

DDファイル内に以下のいずれかが存在するか確認：
- `## 実装前チェック`
- `## Phase N 詳細設計` 内に同等の情報

### Step 3: 参照ファイルの存在確認

記載されている参照ファイルが実際に存在するか確認。

### Step 4: チェック内容の検証

仕様書と既存コードを実際に読み、DDに記載された内容と照合。

## 結果出力

### 出力フォーマット

```markdown
## 実装前チェック検証結果

### 対象
- DD: DD-005_認証機能の実装.md
- Phase: Phase 2

### チェック状況

| 項目 | 状態 | 備考 |
|------|:---:|------|
| 仕様書確認 | ✓ | 機能一覧、画面仕様 参照済 |
| テーブル定義確認 | ✓ | テーブル定義書 参照済 |
| 既存コード確認 | ✓ | Controller 参照済 |
| 差分検証 | ✓ | 漏れなし |

### 検証結果

**OK**: 実装前チェックが適切に実施されています。

または

**NG**: 以下の項目が不足しています：
- [ ] テーブル定義の確認が記録されていない
- [ ] 既存コードの参照先が不明確
```

## 不足時の対応

チェックが不足している場合、以下を実施：

1. 不足項目を特定
2. 該当ドキュメント/コードを読み込み
3. DDの「実装前チェック」セクションを更新
4. 再度 `/review-spec` で検証

## 関連コマンド

| コマンド | 用途 |
|----------|------|
| `/dd {番号}` | DDの参照・編集 |
| `/review` | コード・ドキュメントのレビュー |
