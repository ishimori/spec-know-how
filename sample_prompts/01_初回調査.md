# サンプルプロンプト: Gate 1 — 初回調査

対応 Gate: [gates/01_initial_survey.md](../gates/01_initial_survey.md)

---

## DD 起票プロンプト

> `<コードベースのパス>` を実際のパスに置き換えてください。

```
以下の作業を DD に分割して起票・実行してください。
作業の粒度を判断し、適切な数の DD に分けてください（目安: 2〜3 DD）。
各 DD 完了時に DA 批判レビューを実施してください。

<コードベースのパス> に配置したコードベースを分析し、初回調査を行います。

> **事前スコープ確認**: コードベースのファイル数・LOC を概算で把握し、
> ファイル数が多い（目安: 300 以上）または複数のサブシステムが混在する場合は、
> 調査範囲を分割した DD を提案してから作業を継続すること。
> 例: DD-A: フロントエンド調査 / DD-B: バックエンド調査

---

## 作業 1: コードベースの把握

- [ ] ディレクトリ構造を確認し、主要フォルダの役割がわかる
- [ ] 技術スタックを確認した（言語・フレームワーク・バージョン）
- [ ] LOC（行数）およびファイル数を把握した
- [ ] 主要なエントリポイント（main.py、index.ts 等）を特定した

---

## 作業 2: 既存ドキュメント・体制・環境の把握

- [ ] README や既存ドキュメントの有無を確認した
- [ ] ドキュメントとコードの間に明らかな食い違いがないか確認した（ある場合はメモした）
- [ ] コードコメントや docstring の量・質を確認した
- [ ] CI/CD の有無と構成を確認した（ある場合）
- [ ] 本番・ステージング・開発環境の構成を確認した（ある場合）
- [ ] コードの所有者・担当者を確認した（ある場合）

---

## 作業 3: コンテキストファイルの設計

初回調査で把握したプロジェクトの全体像をもとに、doc/context/ のファイル構成を設計してください。

- [ ] このプロジェクトに必要なコンテキストファイルの一覧を提案した
  - ファイル名・各ファイルの役割（何を書くか / 何を書かないか）を定義した
  - 原則: 「旧システムの事実記録」と「新システムの設計判断」は必ず別ファイルにする
- [ ] 提案したファイル構成と書き分けルールを CLAUDE.md に記載した
- [ ] CLAUDE.md の仕様書マップにコンテキストファイル一覧を登録した
```

---

## 完了前の確認プロンプト

DD の作業がすべて完了したら、以下をコピーして Claude に貼り付けてください。

```
以下のことを確認してください。

- [ ] 作成した DD にしか記録されていない情報がないこと
  DD は埋もれる可能性が高いため、DD だけが持っている情報は絶対に NG です。
  重要な情報は仕様書・コンテキストファイル等に必ず転記してください。
- [ ] 新たに作成したファイルが CLAUDE.md から辿れる構造になっていること
```

---

## 横断分析（Gate 宣言前に実施）

このフェーズで作成した全 DD を横断的に分析してください。

- [ ] 各 DD を横断し、個別調査では見えなかったパターン・矛盾・見落としを発見した
- [ ] 新たな課題が見つかった場合、新規 DD 起票または既存 DD 更新を行った

> 例：「複数の DD を組み合わせて初めて見えてくるパターン（例：テーブル構造 DD と区分値 DD を合わせると DB 制約なしの重大リスクが浮かぶ）を見逃さないこと。」

---

## Gate 宣言 DD 起票プロンプト

Gate 通過を明示的に記録するための DD を別途起票します。
チェックリストの確認が終わったら、以下をコピーして Claude に貼り付けてください。

> `<確認結果の要約>` と `<未解決事項>` を実際の内容に置き換えてください。

```
以下の内容のDDを作ってください。

Gate 1（初回調査）の通過を宣言します。

## 確認結果
- [ ] gates/01_initial_survey.md のチェックリストを確認した
- [ ] チェックリストの各項目の確認結果を記録した

## 判断
- 通過判定: 通過 / 条件付き通過 / 保留（いずれかを選択）
- 確認結果の要約: <確認結果の要約>
- 未解決事項（ある場合）: <未解決事項と解消計画>

## 次のステップ
- [ ] Step 2（DB・データモデル）および Step 3（画面・UI）に進む
```
