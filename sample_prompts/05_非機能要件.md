# サンプルプロンプト: Gate 5 — 非機能要件

対応 Gate: [gates/05_nfr.md](../gates/05_nfr.md)

---

## DD 起票プロンプト

> `<コードベースのパス>` を実際のパスに置き換えてください。

```
以下の作業を DD に分割して起票・実行してください。
作業の粒度を判断し、適切な数の DD に分けてください（目安: 2〜3 DD）。
各 DD 完了時に DA 批判レビューを実施してください。

<コードベースのパス> のコードベースを分析し、非機能要件について以下を行ってください。

> **事前スコープ確認**: 非機能要件の対象範囲（認証方式・外部サービス数等）を確認し、
> 複数の認証方式が混在する、または外部サービス連携が多い（目安: 5 以上）場合は、
> テーマ別に DD を分割することを提案してから作業を継続すること。
> 例: DD-A: 認証・認可 / DD-B: セキュリティ / DD-C: 運用・監査

---

## 作業 1: 認証・認可・セキュリティ

- [ ] 認証の仕組みを確認した（セッション / JWT / OAuth 等）
- [ ] 認可の仕組みを確認した（ロールベース / リソースベース 等）
- [ ] 未認証時の挙動を確認した（リダイレクト先・エラー応答）
- [ ] SQLインジェクション対策を確認した
- [ ] XSS 対策を確認した
- [ ] CSRF 対策を確認した
- [ ] 機密情報の扱い（パスワード・個人情報等）を確認した

---

## 作業 2: ログ・監査・パフォーマンス

- [ ] アプリケーションログの出力方針を確認した（何をログに残しているか）
- [ ] 監査ログの有無を確認した（誰がいつ何をしたか）
- [ ] ログの保存場所・保存期間を確認した（ある場合）
- [ ] SLA・応答時間の要件を確認した（ある場合）
- [ ] 大量データを扱う処理・バッチ処理を特定した
- [ ] 既知のパフォーマンス問題（N+1 クエリ等）を確認した

---

## 作業 3: 運用・保守

- [ ] バックアップ・リカバリ方針を確認した（ある場合）
- [ ] デプロイ方法を確認した
- [ ] 環境変数・設定ファイルの管理方法を確認した
- [ ] 作成した NFR 仕様書ファイルを CLAUDE.md または document_map.md に追記した
```

---

## 横断分析（Gate 宣言前に実施）

このフェーズで作成した全 DD を横断的に分析してください。

- [ ] 各 DD を横断し、個別調査では見えなかったパターン・矛盾・見落としを発見した
- [ ] 新たな課題が見つかった場合、新規 DD 起票または既存 DD 更新を行った

> 例：「複数の DD を組み合わせて初めて見えてくるパターン（例：テーブル構造 DD と区分値 DD を合わせると DB 制約なしの重大リスクが浮かぶ）を見逃さないこと。」

---

## Gate 宣言 DD 起票プロンプト

> `<確認結果の要約>` と `<未解決事項>` を実際の内容に置き換えてください。

```
以下の内容のDDを作ってください。

Gate 5（非機能要件）の通過を宣言します。

## 確認結果
- [ ] gates/05_nfr.md のチェックリストを確認した
- [ ] チェックリストの各項目の確認結果を記録した
- [ ] 作成した NFR 仕様書ファイルを CLAUDE.md または document_map.md に追記した

## 判断
- 通過判定: 通過 / 条件付き通過 / 保留（いずれかを選択）
- 確認結果の要約: <確認結果の要約>
- 未解決事項（ある場合）: <未解決事項と解消計画>

## 次のステップ
- [ ] Step 6（QA スキル作成）に進む
```
