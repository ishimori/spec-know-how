# DD-010: sample_prompts/ 廃止判断とドキュメント参照整理

| 作成日 | 更新日 | ステータス |
|--------|--------|------------|
| 2026-02-27 | 2026-02-27 | 完了 |

## 目的

sample_prompts/ フォルダの廃止・アーカイブ・存続を決定し、
決定内容に基づいてドキュメント参照（GUIDE.md、README.md、CLAUDE.md 等）を一括整理する。
DD-001 Phase 4 の残課題を正式に引き取り解消する。

## 背景・課題

### 経緯

DD-001（SP スキル導入プロジェクト憲章）で SP チケット群（doc/SP/）の導入を決定し、
DD-002〜007 で sample_prompts/ の各ファイルを分析した上で SP-001〜006 テンプレートを設計・作成した。
DD-001 Phase 4 に「sample_prompts/ の扱いを決定する（廃止 or 誘導用に残す）」が計画されていたが、
DD-001 アーカイブ時に Phase 4 が未着手のまま見落とされた。

### 現状の問題

1. **二重構造の混乱**: 同じ作業目的（仕様抽出 Gate 1〜6）に対して sample_prompts/ と doc/SP/ の2系統が存在する
2. **GUIDE.md の参照先が旧系統のまま**: GUIDE.md は sample_prompts/ を18箇所で参照しているが、SP チケットへの誘導がない
3. **メンテナンスの二重負荷**: CLAUDE.md のメンテナンス方針が sample_prompts/ への反映を指示している

### sample_prompts/ と doc/SP/ の比較

| 観点 | sample_prompts/ | doc/SP/ |
|------|----------------|---------|
| ファイル数 | 8（README + 7テンプレート） | 37+（親 + 子 + context + gate） |
| 環境対応 | なし（環境を問わず同一手順） | SP-000 で環境プロファイリング後、条件分岐 |
| 使い方 | コピー→Claude に貼り付け | Claude がファイルを直接読んで実行 |
| 動的分割 | なし（人間が判断して DD 分割） | 親チケットが条件分岐で子チケットを動的追加 |
| Gate チェック | 人間が目視確認するチェックリスト | 機械処理 + LLM + DA の3段階 QC |
| 引き継ぎ機構 | なし | SP 間の前提確認・context ファイル・引き継ぎリスト |

## 検討内容

### 選択肢

| # | 選択肢 | メリット | デメリット |
|---|--------|---------|-----------|
| A | 完全削除 | 最もシンプル。混乱ゼロ | Git 履歴でしか参照できない |
| B | アーカイブ移動（doc/archived/ 等） | 歴史的参照は維持。新規利用は阻止 | 参照先更新の手間は A と同じ。中途半端な状態 |
| C | 存続（SP への誘導注記を追加） | GUIDE.md の導線を維持 | 二重構造が継続。メンテナンス負荷が残る |

### 影響範囲の詳細

| ファイル | 参照箇所数 | 内容 |
|---------|-----------|------|
| `GUIDE.md` | 18箇所 | DD 起票リンク x6、Gate リンク x6、説明文 x6 |
| `README.md` | 2箇所 | コンテンツ一覧テーブル、ディレクトリ構造ツリー |
| `CLAUDE.md` | 2箇所 | リポジトリ構造テーブル、メンテナンス方針 |
| `manuals/01_仕様書作成マニュアル.md` | 1箇所 | 関連リソーステーブル |
| `doc/SP/*-gate.md` | 5箇所 | sample_prompts 対応行 |

## 決定事項

**採用方針: 選択肢 A — 完全削除**

根拠:
1. 全7テンプレートファイルが SP チケットに完全包含されていることを確認（Phase 1 参照）
2. sample_prompts のコピペ UX は SP 導入後は不要（SP 直接実行の方が確実）
3. Git 履歴で必要な場合は参照可能
4. GUIDE.md の参照先を SP/ に書き換えることで導線は維持される

**修正対象と修正内容:**

| ファイル | 箇所 | 修正内容 |
|---------|------|---------|
| `GUIDE.md` | 前提セクション（DD の作り方） | sample_prompts 言及を削除し、SP チケットの使い方に変更 |
| `GUIDE.md` | 各 Step 末尾の DD 起票リンク（x6） | `sample_prompts/0N_*.md` → `doc/SP/SP-00N.md` |
| `GUIDE.md` | 各 Step 末尾の Gate リンク（x6） | `sample_prompts/0N_*.md` → `doc/SP/SP-00N-gate.md` |
| `GUIDE.md` | 注記（Gate 番号体系）| sample_prompts 参照を削除 |
| `README.md` | コンテンツ一覧テーブル | `sample_prompts/` 行を削除 |
| `README.md` | ディレクトリ構造ツリー | `sample_prompts/` エントリを削除 |
| `CLAUDE.md` | リポジトリ構造テーブル | `sample_prompts/` 行を削除 |
| `CLAUDE.md` | メンテナンス方針 | sample_prompts への反映指示を削除 |
| `manuals/01_仕様書作成マニュアル.md` | 関連リソーステーブル | sample_prompts 行を削除または SP に変更 |
| `doc/SP/SP-002-gate.md` | マニュアル対応行 | `sample_prompts/02_DBデータモデル.md` 参照を削除 |
| `doc/SP/SP-003-gate.md` | マニュアル対応行 | `sample_prompts/03_画面UI.md` 参照を削除 |
| `doc/SP/SP-004-gate.md` | マニュアル対応行 | `sample_prompts/04_業務ロジック.md` 参照を削除 |
| `doc/SP/SP-005-gate.md` | マニュアル対応行 | `sample_prompts/05_非機能要件.md` 参照を削除 |
| `doc/SP/SP-006-gate.md` | マニュアル対応行 | `sample_prompts/06_QA準備完了.md` 参照を削除 |

## タスク一覧

### Phase 0: 事前精査
- [x] 📋 **各 Phase のタスク精査・詳細化**（完了。Phase 1〜4 の詳細を下記に記録）
- [x] 😈 **Devil's Advocate 調査**（完了。DA 批判レビュー記録を参照）

### Phase 1: 重複度・独自価値の精査
- [x] sample_prompts/ の各ファイル（00〜06）と対応 SP チケットの内容を比較し、重複度を定量化した
- [x] sample_prompts/README.md の「DD の粒度について」「分割トリガーの目安」が SP テンプレート内に反映済みか確認した
- [x] Gate チェックリスト（人間確認用）が SP-gate チケットに同等以上で含まれているか確認した
- [x] 「DD 起票プロンプト」形式が持つ固有の価値（コピペ運用、SP スキル未導入環境）を評価した
- [x] 😈 **DA 批判レビュー（完了。DA 批判レビュー記録を参照）**

### Phase 2: 方針決定
- [x] Phase 1 の調査結果と DA 観点を踏まえ、選択肢 A を採用した（完全削除）
- [x] 決定事項を本 DD に記録した
- [x] 決定に基づく具体的な修正対象ファイルと修正内容の一覧を作成した（決定事項セクション参照）
- [x] 😈 **DA 批判レビュー（完了。DA 批判レビュー記録を参照）**

### Phase 3: ドキュメント参照の一括修正
- [x] GUIDE.md の sample_prompts/ 参照を修正した（前提セクション + 各 Step x6 SP チケットリンク + Gate リンク + 注記）
- [x] README.md のコンテンツ一覧とディレクトリ構造を更新した（2箇所）
- [x] CLAUDE.md のリポジトリ構造テーブルとメンテナンス方針を更新した（2箇所）
- [x] manuals/01_仕様書作成マニュアル.md の関連リソーステーブルを更新した（1箇所）
- [x] doc/SP/*-gate.md の sample_prompts 参照を削除した（5箇所）
- [x] 😈 **DA 批判レビュー完了（DA 批判レビュー記録を参照）**

### Phase 4: sample_prompts/ フォルダの処理
- [x] sample_prompts/ フォルダを削除した（git rm -r。8ファイル削除）
- [x] CHANGELOG.md に v0.7.0 としてバージョンアップ記録を追加した
- [x] 😈 **DA 批判レビュー完了（DA 批判レビュー記録を参照）**

## ログ

### 2026-02-27
- DD 作成（DD-001 Phase 4 の残課題を引き取り）
- Phase 0 DA 調査実施・Phase 1 重複度分析完了・Phase 2 方針決定（選択肢 A: 完全削除）
- Phase 3: GUIDE.md/README.md/CLAUDE.md/manuals/SP-gate 全参照を修正
- Phase 4: sample_prompts/ を git rm で削除（8ファイル）。CHANGELOG.md に v0.7.0 を追記。DD-010 完了

---

## Phase 1: 重複度分析記録

### 各ファイルの重複度判定

| sample_prompts ファイル | 対応 SP | 判定 | 根拠 |
|----------------------|---------|------|------|
| `00_Claude初期設定.md` | SP-000 | **完全包含** | 作業1〜3（CLAUDE.md整備・仕様書マップ・機械分析スクリプト）が SP-000 に包含。さらに環境プロファイリングを追加 |
| `01_初回調査.md` | SP-001 + 01〜03 + context + gate | **完全包含** | 作業1〜3 が SP-001-01〜03 に分解。横断分析は SP-001-gate Phase 4-5 に含まれる |
| `02_DBデータモデル.md` | SP-002 + 01〜03 + context + gate | **完全包含** | 作業1〜4 が SP-002-01〜03 に分解。実 DB 照合は SP-002-03 が担当 |
| `03_画面UI.md` | SP-003 + 01〜03 + context + gate | **完全包含** | 作業1〜3 が SP-003-01〜03 に分解。認可マトリクス要件を強化 |
| `04_業務ロジック.md` | SP-004 + 01〜03 + context + gate | **完全包含** | DD-005 で大幅再設計。動的分割・フラグライフサイクル・引き継ぎ機構を追加 |
| `05_非機能要件.md` | SP-005 + 01〜04 + context + gate | **完全包含** | 作業3分割→4分割に拡張（認証・セキュリティ・ログ・運用を分離） |
| `06_QA準備完了.md` | SP-006 + 01〜03 + gate | **完全包含** | 作業1〜3 が SP-006-01〜03 に分解。仕様書品質確認を強化 |
| `README.md` | — | **概ね包含** | 「分割トリガーの目安」テーブルは SP 親チケットの動的分割条件に吸収済み。「使い方」は SP の運用フローに置き換わった |

### Gate チェックリストの包含確認

| sample_prompts Gate チェックリスト | SP-gate 対応 | 同等以上か |
|--------------------------------|------------|---------|
| Gate 0（CLAUDE.md・doc/context/ 確認） | SP-000 完了条件 | ✅ 同等以上 |
| Gate 1（コードベース把握・ドキュメント把握） | SP-001-gate Phase 1〜3 | ✅ 同等以上（機械処理確認を追加） |
| Gate 2（スキーマ・テーブル・マスタデータ） | SP-002-gate Phase 1〜3 | ✅ 同等以上 |
| Gate 3（画面一覧・権限・ビジネスロジック） | SP-003-gate Phase 1〜3 | ✅ 同等以上（認可マトリクスを追加） |
| Gate 4（業務ロジック・信頼度・突合） | SP-004-gate Phase 1〜3 | ✅ 同等以上 |
| Gate 5（認証・ログ・パフォーマンス・セキュリティ・運用） | SP-005-gate Phase 1〜3 | ✅ 同等以上 |
| Gate 6（QA スキル・仕様書品質・更新の仕組み） | SP-006-gate Phase 1〜3 | ✅ 同等以上 |

---

## DA 批判レビュー記録

### Phase 0〜2 DA 批判レビュー

**DA 観点:** sample_prompts 削除によって何が壊れるか

| # | 発見した問題/改善点 | 重要度 | 再現手順 | DA 観点 | 対応 |
|---|-------------------|--------|----------|--------|------|
| 1 | GUIDE.md の各 Step 末尾に「DD 起票」リンクがあるが、リンク先のファイル名が `sample_prompts/01_initial_survey.md`（英語名）と `sample_prompts/01_初回調査.md`（日本語名）が混在している。削除前に両方のパターンを grep で確認が必要 | 中 | GUIDE.md を grep して `sample_prompts` を含む行を全列挙 → 英語ファイル名（`01_initial_survey.md`）が存在するか確認 | 「SP に完全包含か」の DA 観点 | Phase 3 作業前に grep で全バリアントを確認してから修正 |
| 2 | sample_prompts/README.md の「使い方」セクションには「Gate チェックリスト（人間が確認）」という人間向け確認の概念が明示されている。SP gate チケットは Claude が実行するものであり、「人間が最終判定する」という点が SP gate の Phase 6 にしか明示されていない可能性がある | 低 | SP-001-gate を読み、人間による Go/No-Go 最終判定が明示されているか確認 | 「SP 未導入環境ユーザーへの影響」の DA 観点 | ✅修正済：GUIDE.md 前提セクションに「Gate の通過判定（Go/No-Go）は人間が最終決定します」を明記した |
| 3 | GUIDE.md の DD 起票リンクが英語ファイル名（`01_initial_survey.md` 等）を参照しており、実ファイルが存在しない壊れたリンクだった（sample_prompts/ には日本語名ファイルのみ存在） | 中 | GUIDE.md の sample_prompts リンクをクリック → 404 | Phase 3 の grep で発見 | ✅修正済：SP チケットへの正しいリンクに置き換えた |
| 4 | Phase 4 DA: git rm 後に他ブランチ・PR で sample_prompts を参照している可能性がある | 低 | dev6 ブランチのみで作業しているため影響なし | フォルダ削除の影響範囲 | ❌不要：単一ブランチ作業のため影響なし |
