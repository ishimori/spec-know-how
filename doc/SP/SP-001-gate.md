# SP-001-gate: Gate チェック（機械処理 + LLM + DA分析）

| 作成日 | 更新日 | ステータス |
|--------|--------|------------|
| - | - | 未開始 |

> **前提**: SP-001-context.md を含む全子チケットが完了していること。

---

## このチケットの位置づけ

**全体目標**: このSPシリーズは [manuals/01_仕様書作成マニュアル.md](../../manuals/01_仕様書作成マニュアル.md) の Step 0〜4 完了を目指す — レガシーシステムから [VERIFIED] 仕様書を抽出し、生成AIによるリエンジニアリングを可能にする。

**マニュアル対応**: [manuals/01_仕様書作成マニュアル.md](../../manuals/01_仕様書作成マニュアル.md) — **Gate 1「ドキュメント棚卸し完了基準」**（3.2 Gate 1）

**目的**: SP-001 全体の成果物を横断的に検証し、人間が Go/No-Go を判断できる状態を作る。
「だいたい合っているだろう」を排除し、機械検証 + LLM 検証 + DA 分析の3層で確認する。

**最終的な使われ方**: Gate 判定サマリーを人間が読んで DD（Gate 宣言）を起票する。
Gate 通過後、SP-002（DB・データモデル）以降に進む。

**実行 Phase の判断**: 全 Phase 必須・スキップ不可

---

## Phase 1: 前提確認（LLM）

SP-001.md の「子チケット一覧」を読み、全チケットのステータスが「完了」か確認する。

- [ ] 全子チケットのステータスが「完了」であることを確認した

---

## Phase 2: 機械検証

> **実行者: ユーザー**。以下のコマンドをターミナルで実行し、出力をそのまま貼り付けてください。
> Claude はその結果を読み取って判定します。LLM の記憶や推測に頼らない。
>
> 貼り付けフォーマット（監査用）:
> ```
> # 実行コマンド
> <ここにコマンドを記載>
> # 実行結果
> <ここに出力を貼り付け>
> ```

| チェック項目 | 実行コマンド（ユーザーが実行） | 結果 | 判定 |
|------------|--------------------------|------|------|
| LOC・ファイル数の把握 | SP-001-02.md の結果テーブルを参照（機械処理済み） | - | Pass / Fail |
| README や既存ドキュメントの有無 | `find {パス} -maxdepth 2 -name "README*"` | - | Pass / Fail |
| CI/CD ファイルの存在 | `ls {パス}/.github/workflows/ 2>/dev/null; find {パス} -maxdepth 2 -name "Jenkinsfile" -o -name ".travis.yml" -o -name ".circleci"` | - | Pass / Fail |
| 依存関係ファイルの存在 | `find {パス} -maxdepth 2 -name "requirements*.txt" -o -name "pyproject.toml" -o -name "package.json"` | - | Pass / Fail |
| コンテキストファイルの CLAUDE.md 登録 | `grep -n "context" {CLAUDE.mdのパス}` | - | Pass / Fail |

---

## Phase 3: LLM 検証

> 各子チケットのファイルを実際に読んで確認すること。「たぶん書いてあった」禁止。

- [ ] SP-001-01.md を読み、ディレクトリ構造・主要フォルダの役割・技術スタック・エントリポイントが記録されていることを確認した
- [ ] SP-001-02.md を読み、LOC・ファイル数・依存ライブラリ・テストコード情報が記録されていることを確認した
- [ ] SP-001-03.md を読み、ドキュメントとコードの食い違い・コメント量・環境構成・担当者情報が記録されていることを確認した
- [ ] SP-001-context.md を読み、コンテキストファイルの構成設計と作成記録があることを確認した

### 検証記録

| チェック項目 | 確認結果 | 備考 |
|-----------|---------|------|
| ディレクトリ構造・主要フォルダの役割把握 | OK / NG / 部分的 | - |
| 技術スタック・エントリポイントの特定 | OK / NG / 部分的 | - |
| ドキュメントとコードの食い違い確認 | OK / NG / 部分的 | - |
| コメント・docstring の量・質 | OK / NG / 部分的 | - |
| 環境構成・担当者の把握 | OK / NG / 部分的 | - |
| コンテキストファイル設計の完了 | OK / NG / 部分的 | - |

---

## Phase 4: DA 分析（全体横断・必須）

> 各子チケットのスコープを超えた横断的な観点で確認する。
> 問題がなければ「なし」と記録すること。

**確認観点:**
- サブシステムや外部連携の見落としはないか？
- 各子チケットの成果物間で矛盾はないか？
- 機械検証と LLM 検証の結果に乖離はないか？
- Uncertain 判定の項目に追加調査が必要か？

| # | 発見した問題・懸念 | 重要度 | 対応方針 |
|---|----------------|--------|---------|
| - | なし | - | - |

---

## Phase 5: コンテキスト最終回収

> Gate チェック実施中に会話コンテキストにのみ残っている情報を最後にすべて回収する。

- [ ] 全子チケット・全調査を通じてコンテキストにしか残っていない情報がないか確認し、あれば該当チケットに追記した

---

## Phase 6: Gate 判定サマリー（Claude が生成）

### 検証結果一覧

| カテゴリ | チェック項目 | 判定 | 備考 |
|--------|------------|------|------|
| 機械検証 | LOC・ファイル数の把握 | - | - |
| 機械検証 | README・既存ドキュメントの有無 | - | - |
| 機械検証 | CI/CD ファイルの存在 | - | - |
| 機械検証 | 依存関係ファイルの存在 | - | - |
| 機械検証 | コンテキストファイルの CLAUDE.md 登録 | - | - |
| LLM 検証 | ディレクトリ構造・フォルダ役割の把握 | - | - |
| LLM 検証 | 技術スタック・エントリポイントの特定 | - | - |
| LLM 検証 | ドキュメントとコードの食い違い確認 | - | - |
| LLM 検証 | コメント・docstring の量・質 | - | - |
| LLM 検証 | 環境構成・担当者の把握 | - | - |
| LLM 検証 | コンテキストファイル設計の完了 | - | - |

### 推奨判定

- **推奨**: 通過 / 条件付き通過 / 保留
- **理由**: （記載）
- **懸念事項**: （なければ「なし」）

---

## 完了時の確認

- [ ] SP-001 の子チケット一覧の本チケットを「完了」に更新した
- [ ] 上の Gate 判定サマリーをユーザーに提示した

---

## Gate 宣言 DD 起票プロンプト

> Gate 判定サマリーを確認後、コピーして Claude に貼り付けてください。

```
以下の内容の DD を作ってください。

Gate 1（初回調査）の通過を宣言します。

## 確認結果
- [ ] SP-001-gate.md の Gate 判定サマリーを確認した

## 判断
- 通過判定: 通過 / 条件付き通過 / 保留（いずれかを選択）
- 確認結果の要約: <確認結果の要約>
- 未解決事項（ある場合）: <未解決事項と解消計画>

## 次のステップ
- [ ] Step 2（DB・データモデル）および Step 3（画面・UI）に進む
```
