# SP-001-01: コードベースの定量把握（手動）

| 作成日 | 更新日 | ステータス |
|--------|--------|------------|
| 2026-03-02 | 2026-03-02 | 完了 |

> **前提**: SP-001.md の管理記録からコードベースのパスを確認してから作業を開始すること。

---

## このチケットの位置づけ

**全体目標**: このSPシリーズは [manuals/01_仕様書作成マニュアル.md](../../manuals/01_仕様書作成マニュアル.md) の Step 0〜4 完了を目指す — レガシーシステムから [VERIFIED] 仕様書を抽出し、生成AIによるリエンジニアリングを可能にする。

**マニュアル対応**: [manuals/01_仕様書作成マニュアル.md](../../manuals/01_仕様書作成マニュアル.md)
- Phase 1（コードベース） → **Step 1「ドキュメント棚卸し」の準備段階**
- Phase 2（DB/スキーマ） → **Step 2「業務ロジック抽出」の事前準備**（DB規模の把握）

**目的**: コードベース・DB など各資産の規模・構造を定量的に把握し、
SP-001-02（機械処理）・SP-001-03（ドキュメント棚卸し）・SP-001-context（コンテキスト設計）の
調査方針と記録粒度を決める。

**最終的な使われ方**: 収集情報は `SP-001-context.md` に集約され、
**SP-002 以降の AI セッションが「このシステムの構成」を理解するための基盤データ**となる。
信頼度の低い情報をここに混入させると後工程の AI が誤った判断をするため、
確認できた事実と推測を明確に区別して記録すること。

**実行する Phase の判断**:

| Phase | 実行条件 |
|-------|---------|
| Phase 1: コードベース | **常に実行** |
| Phase 2: DB / スキーマ | SP-000 グループC「DB 有無」が **あり** の場合のみ |

---

## Phase 1: コードベースの定量把握

> チェックを入れるだけでなく、調査結果を下の「調査記録」テーブルに記録すること。

- [x] ディレクトリ構造を確認し、主要フォルダの役割がわかる
- [x] 技術スタック（言語・フレームワーク・バージョン）を確認した
- [x] 主要なエントリポイント（main.py、index.ts 等）を特定した
- [x] **サブシステム境界の仮説を立てた**（例: 複数アプリ / バッチ / 管理画面 / 共通ライブラリ など）
  - サブシステムが確認できなければ「なし（モノリシック）」と記録する
- [x] **（SP-000 グループD「フロントエンドあり」の場合のみ）** FE のフォルダ構成・コンポーネント数（概算）を確認した

### 調査記録

| 項目 | 調査結果 | 信頼度 |
|------|---------|--------|
| 主要フォルダ構成・役割 | `app_core/`（コアライブラリ 8モジュール）/ `Intermediate/`（中間CSV・JSON）/ `Result_260202/`（出力CSV・CDXML）/ ルート `.cdxml` ×5（材料マスタ）/ `patent_support.ipynb`（エントリポイント）/ `result_with_id.csv`（結果サマリ） | High |
| 技術スタック（言語・FW・バージョン） | Python 3.10.11 / JupyterLab（Jupyter Notebook実行環境）/ ipywidgets + anywidget（UI）/ RDKit（化学計算）/ pandas・numpy・seaborn（データ処理）/ Pillow（画像生成）/ traitlets（状態管理） | High |
| 主要エントリポイント | `patent_support.ipynb` Cell 0: `from app_core import launch_app; app = launch_app("./")` | High |
| サブシステム有無・内訳（→ SP-001 管理記録に転記） | なし（モノリシック）。機能的に3層: ①UI層（ui.py / App クラス・ipywidgets）②化学計算層（cdxml_extract, mol_calculator, properties, descriptors, render）③データ管理層（ids, util） | Medium |
| 特記事項（気になった点など） | CDXML（ChemDraw XML形式）を入力とする化学構造解析アプリ。レジスト材料の組成・物性計算と結果出力が主機能。CSVが唯一のデータ永続化手段（DBなし）。FEはipywidgets Appクラス（1クラス・大規模：関数50件以上）。 | High |

---

## Phase 2: DB / スキーマの定量把握

> **実行条件**: SP-000 グループC「DB 有無」が **あり** の場合のみ実行。**なし** の場合はこの Phase をスキップ。

SP-000 の「スキーマ情報の形式」に応じて、**該当するセクションのみ**実行する（複数該当も可）。

---

### DDL ファイルがある場合

- [ ] DDL ファイルのパス・ファイル数を確認した
- [ ] テーブル数を概算した

| 項目 | 調査結果 | 信頼度 |
|------|---------|--------|
| DDL ファイルのパス | - | - |
| DDL ファイル数 | - | - |
| テーブル数（概算） | - | - |
| 特記事項 | - | - |

---

### DUMP ファイルがある場合

- [ ] ファイルのパス・サイズを確認した
- [ ] テーブル数を概算した（DUMP から読み取れる範囲で）

| 項目 | 調査結果 | 信頼度 |
|------|---------|--------|
| DUMP ファイルのパス | - | - |
| ファイルサイズ | - | - |
| テーブル数（概算） | - | - |
| 特記事項 | - | - |

---

### マイグレーションファイルがある場合

- [ ] マイグレーションツール・ファイル数を確認した
- [ ] テーブル数を概算した

| 項目 | 調査結果 | 信頼度 |
|------|---------|--------|
| マイグレーションツール（Alembic / Flyway 等） | - | - |
| マイグレーションファイル数 | - | - |
| テーブル数（概算） | - | - |
| 特記事項 | - | - |

---

### ER 図・設計書がある場合

- [ ] ドキュメントの場所・形式を確認した
- [ ] テーブル数（記載分）を確認した

| 項目 | 調査結果 | 信頼度 |
|------|---------|--------|
| ER 図・設計書のパス / 形式 | - | - |
| テーブル数（記載分） | - | - |
| 信頼度の所感（最新か？コードと一致しそうか？） | - | - |
| 特記事項 | - | - |

---

### モデル定義のみの場合（コードから読み取る）

- [ ] モデルファイルの場所・数を確認した
- [ ] モデルクラス数を概算した

| 項目 | 調査結果 | 信頼度 |
|------|---------|--------|
| モデルファイルのパス | - | - |
| モデルファイル数 | - | - |
| モデルクラス数（概算） | - | - |
| 特記事項 | - | - |

---

## DA 分析（このチケットのスコープ限定）

> 「このチケットの調査で何を見落としているか？」の観点で批判的に確認する。
> 問題がなければ「なし」と記録すること（無理に問題を作らない）。

| # | 発見した問題・懸念 | 重要度 | 対応方針 |
|---|----------------|--------|---------|
| - | なし | - | - |

---

## コンテキスト回収

> この作業中に会話コンテキストにのみ存在する知見・気づきがあれば、上の作業セクションまたは下の「追加タスク」に追記する。
> 「特になし」でよい場合はそのまま完了へ進む。

- [x] コンテキストにしか残っていない重要な情報がないか確認した

---

## 発覚した追加タスク

| # | 追加タスク | 起票要否 |
|---|----------|---------|
| - | - | - |

---

## 完了時の確認

- [x] SP-001 の子チケット一覧の本チケットを「完了」に更新した
