# SP-005-03: ログ・監査・パフォーマンス

## このチケットの位置づけ

**全体目標**: このSPシリーズは [manuals/01_仕様書作成マニュアル.md](../../manuals/01_仕様書作成マニュアル.md) の Step 5（非機能要件を確認する）完了を目指す — 認証・認可・セキュリティ・ログ・運用を仕様として文書化し、後続の QA スキル構築の根拠とする

**マニュアル対応**: [manuals/01_仕様書作成マニュアル.md](../../manuals/01_仕様書作成マニュアル.md) — **Step 5「非機能要件を確認する」**

**目的**: アプリケーションログ・監査ログの有無と方針、SLA・パフォーマンス要件・既知の問題を記録する

**実行 Phase の判断**:

| Phase | 実行条件 |
|-------|---------|
| Phase 1 | 常に実行（ログ・監査） |
| Phase 2 | 常に実行（パフォーマンス） |

---

## Phase 1: ログ・監査の確認

- [ ] アプリケーションログの出力方針を確認した（ログライブラリ・ログレベル・出力先）
- [ ] 監査ログの有無を確認した（誰がいつ何をしたかの記録）
  - **監査ログなしの場合**: 「なし」と明記して完了とする（移行先での追加要否はユーザーが判断）
- [ ] ログの保存場所・保存期間を確認した（ある場合）

### 調査記録（Phase 1）

| 項目 | 確認結果 | コード根拠 / 設定ファイル | 信頼度 |
|------|---------|------------------------|--------|
| ログライブラリ | - | - | High / Medium / Low |
| ログレベル設定 | - | - | High / Medium / Low |
| ログ出力先 | - | - | High / Medium / Low |
| 監査ログ有無 | あり / なし | - | High / Medium / Low |
| ログ保存期間 | - | - | High / Medium / Low |

**監査ログの内容（ある場合）:**

| 記録項目 | 保存先テーブル / ファイル | 信頼度 |
|---------|---------------------|--------|
| - | - | High / Medium / Low |

---

## Phase 2: パフォーマンスの確認

- [ ] SLA・応答時間の要件を確認した（ドキュメント・コメント・設定値等から把握）
  - **要件なしの場合**: 「要件なし（慣行・現状値として〇秒程度）」と記録する
- [ ] 大量データを扱う処理・バッチ処理を特定した
- [ ] 既知のパフォーマンス問題を確認した（N+1 クエリ・重いクエリ・ループ内 API 呼び出し等）

### 調査記録（Phase 2）

| 項目 | 確認結果 | 根拠 / コード根拠 | 信頼度 |
|------|---------|----------------|--------|
| SLA / 応答時間要件 | - | - | High / Medium / Low |
| 大量データ処理 / バッチ処理 | あり / なし | - | High / Medium / Low |
| 既知のパフォーマンス問題 | あり / なし | - | High / Medium / Low |

**バッチ処理一覧（ある場合）:**

| バッチ名 | 処理概要 | 実行タイミング | データ量概算 |
|---------|---------|------------|-----------|
| - | - | - | - |

**既知のパフォーマンス問題（ある場合）:**

| 問題の概要 | 発生箇所（ファイルパス:行番号） | 重要度 | 対応方針 |
|----------|--------------------------|--------|---------|
| - | - | 高 / 中 / 低 | - |

---

## DA 分析（このチケットのスコープ限定）

> 「監査ログの欠落が規制要件違反になる可能性はないか？パフォーマンス問題が隠れていないか？」の観点で批判的に確認する。
> 問題がなければ「なし」と記録すること（無理に問題を作らない）。

| # | 発見した問題・懸念 | 重要度 | 対応方針 |
|---|----------------|--------|---------|
| - | なし | - | - |

---

## コンテキスト回収

> この作業中に会話コンテキストにのみ存在する知見・気づきがあれば、
> 上の作業セクションまたは下の「追加タスク」に追記する。

- [ ] コンテキストにしか残っていない重要な情報がないか確認した

---

## 発覚した追加タスク

| タスク内容 | 対応先 | 優先度 |
|----------|--------|--------|
| - | - | - |

---

## 完了時の確認

- [ ] SP-005 の子チケット一覧の本チケットを「完了」に更新した
