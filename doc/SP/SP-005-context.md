# SP-005-context: NFR 仕様書ファイル構成設計

## このチケットの位置づけ

**全体目標**: このSPシリーズは [manuals/01_仕様書作成マニュアル.md](../../manuals/01_仕様書作成マニュアル.md) の Step 5（非機能要件を確認する）完了を目指す — 認証・認可・セキュリティ・ログ・運用を仕様として文書化し、後続の QA スキル構築の根拠とする

**マニュアル対応**: 特定の Step に非対応（全工程を横断）— SP-005-01〜04（および動的追加チケット）の成果物を集約し、永続的な NFR 仕様書ファイルの構成を設計する

**目的**: SP-005-01〜04（および動的追加チケットを含む全子チケット）の調査結果を統合し、後続の QA スキル・SP-006 が参照する NFR 仕様書ファイルの構成を設計して実際に作成する

**最終的な使われ方**: ここで設計したファイル構成に従って NFR 仕様書を作成する（実際のファイル作成はこのチケット内で行う）。作成したファイルは `CLAUDE.md` または `document_map.md` に **キーワード → ファイルパス** のマッピング形式で追記する

**実行 Phase の判断**:

| Phase | 実行条件 |
|-------|---------|
| Phase 1 | 常に実行（SP-005-01〜04 および動的追加チケット完了後） |

---

## Phase 1: NFR 仕様書ファイル構成設計・作成

- [ ] SP-005-01〜04（および動的追加チケット）の調査記録をすべて読んだ
- [ ] NFR 仕様書として作成すべきファイルの構成を設計した
- [ ] 設計したファイルを作成した
- [ ] 作成したファイルを `CLAUDE.md` または `document_map.md` に **キーワード → ファイルパス** のマッピング形式で追記した
- [ ] SP-005-04 で発見されたハードコード秘匿情報が SP-005-02 にも記録されていることを確認した

### 設計記録

| ファイル名（案） | 役割（何を書くか） | 書かないもの | 対応する調査元 | CLAUDE.md キーワード例 |
|--------------|---------------|------------|-------------|---------------------|
| `doc/spec/nfr/auth.md` | 認証フロー・認可マトリクス（3層）・未認証挙動 | セキュリティ対策の詳細 | SP-005-01 | 認証, 認可, ロール, ログイン, JWT |
| `doc/spec/nfr/security.md` | セキュリティ対策状況・機密情報管理 | 認証・認可フロー | SP-005-02 | セキュリティ, SQLi, XSS, CSRF, 個人情報 |
| `doc/spec/nfr/observability.md` | ログ・監査・パフォーマンス要件・既知の問題 | 運用手順 | SP-005-03 | ログ, 監査, パフォーマンス, バッチ, N+1 |
| `doc/spec/nfr/operations.md` | バックアップ・デプロイ・環境変数管理 | ビジネスロジック | SP-005-04 | デプロイ, バックアップ, 環境変数 |

> 上記は推奨最小構成。プロジェクトの規模・複雑さに応じて統合または分割すること。

### CLAUDE.md または document_map.md への追記（記録）

> 実際に追記した内容を貼り付ける（監査用）。

```
（追記内容をここに貼り付け）
```

---

## DA 分析（このチケットのスコープ限定）

> 「NFR 仕様書のキーワードマッピングで、QA スキルが「認証について」「セキュリティについて」と聞かれたときに正しく引けるか？SP-006 横断検証に必要な情報が揃っているか？」の観点で批判的に確認する。
> 問題がなければ「なし」と記録すること（無理に問題を作らない）。

| # | 発見した問題・懸念 | 重要度 | 対応方針 |
|---|----------------|--------|---------|
| - | なし | - | - |

---

## コンテキスト回収

- [ ] コンテキストにしか残っていない重要な情報がないか確認した

---

## 発覚した追加タスク

| タスク内容 | 対応先 | 優先度 |
|----------|--------|--------|
| - | - | - |

---

## 完了時の確認

- [ ] SP-005 の子チケット一覧の本チケットを「完了」に更新した
