# DD-{番号}: 移行先設計

| 作成日 | 更新日 | ステータス | ステージ |
|--------|--------|------------|----------|
| {日付} | {日付} | 進行中 | Post |

## 前提 DD

- Stage 5: 最終仕様（完了必須。スキップ時は Stage 3 完了でも可）

## スキップ判定

### 判定条件
移行予定がない場合（既存システムの仕様文書化のみが目的）。

### 判定方法
Stage 2 の「Post DD のスキップ判定」テーブルを確認。
ユーザーに移行意図を確認しても良い。

### スキップ時の記録
このDDをスキップする場合:
1. ステータスを「スキップ」に変更
2. 「移行予定なし。仕様文書化のみが目的。」と記録
3. ポートフォリオインデックス DD の該当行を更新

## 目的

抽出した仕様に基づき、移行先システムのアーキテクチャを設計する。
どの技術スタックに、どのような構成で移行するかを決定する。

## 背景・課題

仕様が明確になった後、移行先の技術選定と設計が必要。
既存システムの制約を引きずらない設計を目指す。

## 検討内容

### 技術スタック候補

| 層 | 候補 | メリット | デメリット | 評価 |
|-----|------|---------|----------|------|
| フロントエンド | | | | |
| バックエンド | | | | |
| DB | | | | |
| インフラ | | | | |

### データ移行マッピング

| 既存テーブル | 移行先テーブル | 変換ルール | リスク |
|------------|-------------|----------|--------|

## 決定事項

（設計完了後に記入）

## 成果物

| 成果物 | 配置先 | 状態 |
|--------|--------|------|
| アーキテクチャ設計書 | 本 DD 内 | 未作成 |
| データ移行計画 | 本 DD 内 | 未作成 |
| リスク評価 | 本 DD 内 | 未作成 |

## タスク一覧

### Phase 0: 事前精査
- [ ] 📋 各 Phase のタスク精査・詳細化
- [ ] 📋 最終仕様書の確認（Stage 5 または Stage 3 の成果物）
- [ ] 😈 **Devil's Advocate調査**

### Phase 1: 技術選定
- [ ] フロントエンド技術の選定
- [ ] バックエンド技術の選定
- [ ] DB / ORM の選定
- [ ] インフラ（ホスティング、CI/CD）の選定
- [ ] 😈 **DA批判レビュー（「このPhaseで何が壊れるか」を最低1件発見）**

### Phase 2: アーキテクチャ設計
- [ ] 全体構成図の作成（Mermaid）
- [ ] モジュール分割の設計
- [ ] API 設計方針
- [ ] 😈 **DA批判レビュー（「このPhaseで何が壊れるか」を最低1件発見）**

### Phase 3: データ移行計画
- [ ] テーブル対応表の作成
- [ ] データ変換ルールの定義
- [ ] マイグレーション手順の設計
- [ ] 😈 **DA批判レビュー（「このPhaseで何が壊れるか」を最低1件発見）**

### Phase 4: リスク評価
- [ ] 技術リスクの洗い出し
- [ ] 移行リスクの洗い出し
- [ ] 対策案の策定
- [ ] 😈 **DA批判レビュー（「このPhaseで何が壊れるか」を最低1件発見）**

## ログ

### {日付}
- DD作成（spec-know-how 起動時に自動生成）

---

## DA批判レビュー記録

### Phase N DA批判レビュー

**DA観点:** （このPhaseで最も壊れやすいポイントは何か？）

| # | 発見した問題/改善点 | 重要度 | 再現手順（高/中は必須） | DA観点 | 対応 |
|---|-------------------|--------|----------------------|--------|------|
| 1 | (具体的に記述) | 高/中/低 | (高/中: 操作→結果) | (どのDA観点で発見したか) | ✅修正済/⏭️別DD/❌不要 |
